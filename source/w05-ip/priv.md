# グローバルアドレスとプライベートアドレス

ここでは、IPv4アドレスの配布形態として、グローバルとプライベートが存在することを知っておきましょう。

## グローバルアドレス

グローバルアドレスは、インターネット上で一意に識別されるIPアドレスです。
前述の通りのことですが、

- 大元はIANA管理
- RIRを通じて各国のNICに配布
- 各NICがプロバイダに配布

という形で手元に届きます。
このようなことから勝手に他人が所有(レンタルと言うべきか)するIPアドレスを勝手に使うことはできません。
当然賃貸料とでも言うべき使用料が発生しています。

プロバイダが毎月費用を取る中からもその料金が含まれていると考えておくといいでしょう。

グローバルアドレスは、インターネット上でユニークであり、対等に通信できることを示しています。この世界において本当は『クライアントもサーバーも存在しない対等な立場』が理想型でした。

## プライベートアドレス

その一方で、実はグローバルアドレスである必要はないのでは?という考え方も存在します。

- 組織の内部で使うコンピューターは、いろいろと検討しないといけない
  - 組織内のコンピューターからのアクセスは必要かもしれない
  - でも、外部からのアクセスは必要ないかもしれない
  - むしろされたらセキュリティ上困ることもありえる
- そのため、組織内で使うコンピューターは、グローバルアドレスを持つ必要はないのでは?

ということで、グローバルアドレス空間の中から、インターネット上でルーティングされない特別な範囲として**プライベートアドレス**が定義されました。
プライベートアドレスはその特徴として『**誰からも断り無く使える**』というものがあります。その代償としての制約も生じていますが、後述します。

少し混乱しやすいですが、グローバルアドレスの説明で登場したクラスがこちらにも存在します。レンジ幅の違いがあるので注意しておいてください。

| クラス | アドレス範囲 | ネットマスク(ビット長) | アドレス数 |
|--------|----------|--------------|------------|
| A      | 10.0.0.0 - 10.255.255.255 | 8            | 16,777,216  |
| B      | 172.16.0.0 - 172.31.255.255 | 12           | 1,048,576   |
| C      | 192.168.0.0 - 192.168.255.255 | 16           | 65,536     |

クラスBが12ビット(CIDRっぽい)ので注意が必要です、そしてクラスCは16ビットのため、フルに使えば65,536台分のレンジになっています[^1]。

[^1]: 正確にはネットワークアドレスとブロードキャストアドレスを差し引いた65534台が正しいです(**ネットワーク上の幅-2**と覚えておけばおおむねOK)。

```{note}
現実的には、クラスCのネットワークから切り出して、24ビットマスクの範囲で使っていることが大半です(24ビットなので256台)。
同様に、クラスAの10.0.0.0/8にしても、切り出して/16相当や、更に分割をして/24にして使っている事例も多いです。
```

実はここまでの話で登場していた192.168.1.0は、クラスCのプライベートアドレス空間のものであるため、特に断り無く使えるものとなっていました。

## プライベートアドレスの制限

プライベートアドレスは断り無く使えるという利点がある一方で、
グローバルアドレスと同じように使うことはできません。

- 誰でも使える
- 裏を返せば『誰が使っているのかわからない』状態でもある
- よって、発信元として使えません
    - 仮に使えたとして、返信先として使われたら『どこの誰?』状態になるのでNG

ということで、ルーター(無線のアクセスポイントなども)は、プライベートアドレスを外部のネットワーク(上流のネットワーク)に流すことは制限されます。
プライベートネットワークとグローバルネットワークの境界となっているルーターはそのルーティング(グローバル側へ流す行為)を禁じています[^2]。

```{note}
まったくできないわけではありません。
今後出てきますが、NATやプロキシなどで外部のネットワークにアクセスすることができます。

その話はもう少し先です。
```

```{note}
もちろん同一プライベートネットワークにおけるプライベートアドレス間の通信は問題無く行われます(というかそういう設計をしないといけない)。
```

[^2]: RFC1918 参照訳より[該当部分と思われる記述部分](https://arc.net/l/quote/ppnborvh)