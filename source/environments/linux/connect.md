# VS codeからの接続

続いて、VS codeから(起動した)仮想マシンに接続します。
初回は少し難しいと思いますが、一回設定を作ると、次回からは比較的スムーズに接続できるので、落ち着いて作業してみてください。

```{warn}
この作業は、授業開始時に毎回行う必要があります。
```

## 接続する

では、接続してみましょう。

1. リモート接続パネルをクリックします
2. `network`を選択します(見えない場合はリロードボタンを確認して押してみてください)
   - ![networkを選ぶ](images/remote-nw.png)
3. このとき右側に2つボタン(アイコン)が出ます、とりあえず{menuselection}`->`(現在のウィンドウで接続)をクリックします
4. 画面が書き換えられ、接続がはじまりました。初回接続先のホスト種別が出るので、Linuxをえらんでください
   - [リモートホスト種別(Linuxを選択)](images/select-remotehost.png)
5. パスワードを聞かれます、文字は出ませんが `penguin` と入れてください
   - [パスワード入力](images/remote-password.png)

接続に成功すると、リモート制御用のツールのダウンロードと準備が行われます。

![リモート接続サーバーのインストール](images/install-vscserver.png)

その後、準備が完了すると、普通のVS codeのような画面に戻ります。
ただし左下に青くリモート接続中であることがわかるように追加がされています。

![リモート接続完了](images/vsc-network.png)

接続が確認できれば今はここまでで大丈夫です。
続いて終了(閉じ方)も確認しておきましょう。

## 接続の閉じ方

VS code側は、未保存がなければ気にせず閉じて大丈夫です。

VirtualBoxは、マネージャー画面に出ているマシン名を右クリックし、 {menuselection}`Stop --> ACPIシャットダウン` としてください。

![ACPIシャットダウンの選択](images/stop-acpishutdown.png)

少し待つと終了します(確認が出た場合はシャットダウンを選べばよい)。
しばらくすると **電源オフ** になります(10秒〜30秒程度)。

```{warning}
きちんと終了せずに放置すると、以下の弊害が生じます。

- 仮想マシン分だけリソースを消費しっぱなしになります
- 気づかずWindowsを終了した場合、異常終了となり、最悪仮想マシンが壊れます
  - 未提出の課題があった場合アクセスできなくなることもあります
```

## 次回以降は…

次回以降は、以下の手順で動かすことになります。

1. VirtualBoxのマネージャーからVMを起動し、30秒程度待つ
2. VS codeのリモート接続から『ネットワーク』を選ぶ
   - 他に起動していなかった場合、VS codeが起動直後に接続を再開しようとします
3. パスワードを聞かれたら再度 `penguin` と入れる
   ※ 早すぎると接続に失敗することがあります

授業終了後にVS codeを閉じての仮想マシンの終了処理を行うようにしてください。
